<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <title>íšŒì› CARE</title>
    <style>
        /* ì»¨í…Œì´ë„ˆ ì¹´ë“œ */
        .table-container {
            background-color: #fff;
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            padding: 20px;
            height: 100%;
        }

        /* ì œëª© */
        .table-title {
            font-weight: 600;
            font-size: 1.2rem;
        }
        .table-description {
            font-size: 0.85rem;
            color: #6c757d;
        }

        /* ìŠ¤í¬ë¡¤ í…Œì´ë¸” */
        .scroll-table {
            height: 500px;
            max-height: 500px;
            overflow-y: auto;
        }
        .scroll-table::-webkit-scrollbar {
            width: 6px;
        }
        .scroll-table::-webkit-scrollbar-thumb {
            background-color: rgba(0,0,0,0.2);
            border-radius: 3px;
        }

        /* í…Œì´ë¸” ì»¤ìŠ¤í…€ */
        .table-custom thead {
            background: linear-gradient(to right, #f8f9fa, #e9ecef);
            font-weight: 600;
        }
        .table-custom tbody tr:hover {
            background-color: #f6faff;
            transition: 0.2s;
        }

        /* ëª¨ë°”ì¼ ì¹´ë“œë·° */
        .card-mobile .card {
            border-radius: 12px;
            border: 1px solid #e9ecef;
        }
        .card-mobile .badge {
            font-size: 0.8rem;
            padding: 0.4em 0.6em;
        }

        /* ë°˜ì‘í˜• ì²˜ë¦¬ */
        @media (max-width: 768px) {
            .scroll-table { display: none; }   /* ëª¨ë°”ì¼ì—ì„œëŠ” í…Œì´ë¸” ìˆ¨ê¹€ */
            .card-mobile { display: block; }
        }
        @media (min-width: 769px) {
            .card-mobile { display: none; }   /* ë°ìŠ¤í¬íƒ‘ì—ì„œëŠ” ì¹´ë“œ ìˆ¨ê¹€ */
        }
    </style>
    <!-- Bootstrap ì•„ì´ì½˜ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
</head>

<main layout:fragment="content">
    <div class="container-fluid py-4">
        <h4 class="fw-bold mb-4"><i class="bi bi-people me-2"></i>íšŒì› CARE</h4>

        <!-- ê²€ìƒ‰ ì˜ì—­ -->
        <form class="d-flex align-items-center gap-2 mb-4" th:action="@{/care}" method="get">
            <input type="text" class="form-control" name="keyword"
                   placeholder="ì´ë¦„ ë˜ëŠ” ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”."
                   th:value="${keyword}" style="width: 300px;" />
            <button type="submit" class="btn btn-outline-secondary">
                <i class="bi bi-search"></i> ê²€ìƒ‰
            </button>
        </form>

        <div class="row g-4">
            <!-- ì²« ìˆ˜ì—… CARE -->
            <div class="col-md-6">
                <div class="table-container">
                    <div class="d-flex align-items-center mb-2">
                        <i class="bi bi-heart-pulse text-danger me-2"></i>
                        <span class="table-title">ì²« ìˆ˜ì—… CARE</span>
                    </div>
                    <p class="table-description">ğŸ©º ì²« ìˆ˜ì—…ì„ ì˜ˆì•½í•œ íšŒì›ë‹˜ë“¤ì…ë‹ˆë‹¤.</p>

                    <!-- ë°ìŠ¤í¬íƒ‘ í…Œì´ë¸” -->
                    <div class="scroll-table">
                        <table class="table table-bordered text-center align-middle table-custom">
                            <thead>
                            <tr>
                                <th>ì´ë¦„</th>
                                <th>ì—°ë½ì²˜</th>
                                <th>íšŒì°¨</th>
                                <th>ì´ íšŸìˆ˜</th>
                                <th>ì˜ˆì•½ì¼ì</th>
                                <th>ì˜ˆì•½ì‹œê°„</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr th:each="pt : ${ptMembers}">
                                <td th:text="${pt.memberName}"></td>
                                <td th:text="${pt.memberPhone}"></td>
                                <td th:text="${pt.count}"></td>
                                <td th:text="${pt.totalCount}"></td>
                                <td th:text="${#temporals.format(pt.sessionDate, 'yyyy-MM-dd')}"></td>
                                <td th:text="${#temporals.format(pt.sessionTime, 'HH:mm')}"></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- ëª¨ë°”ì¼ ì¹´ë“œ -->
                    <div class="card-mobile">
                        <div th:each="pt : ${ptMembers}" class="card shadow-sm mb-2 p-3">
                            <div class="fw-bold" th:text="${pt.memberName}"></div>
                            <div class="text-muted small" th:text="${pt.memberPhone}"></div>
                            <div class="mt-2">
                                <span class="badge bg-info">
                                    íšŒì°¨ [[${pt.count}]] / ì´ [[${pt.totalCount}]]
                                </span>
                            </div>
                            <div class="mt-2 small text-muted">
                                [[${#temporals.format(pt.sessionDate, 'yyyy-MM-dd')}]]
                                [[${#temporals.format(pt.sessionTime, 'HH:mm')}]]
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ë§ˆê° CARE -->
            <div class="col-md-6">
                <div class="table-container">
                    <div class="d-flex align-items-center mb-2">
                        <i class="bi bi-calendar-event text-primary me-2"></i>
                        <span class="table-title">ë§ˆê° CARE</span>
                    </div>
                    <p class="table-description">ğŸ“† ë§ˆê° ì„ë°•í•œ íšŒì›ë‹˜ë“¤ì…ë‹ˆë‹¤.</p>

                    <!-- ë°ìŠ¤í¬íƒ‘ í…Œì´ë¸” -->
                    <div class="scroll-table">
                        <table class="table table-bordered text-center align-middle table-custom">
                            <thead>
                            <tr>
                                <th>ì´ë¦„</th>
                                <th>ì—°ë½ì²˜</th>
                                <th>ìƒí’ˆëª…</th>
                                <th>ì”ì—¬íšŸìˆ˜</th>
                                <th>ì¢…ë£Œì¼</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr th:each="membership : ${membershipMembers}">
                                <td th:text="${membership.memberName}"></td>
                                <td th:text="${membership.phone}"></td>
                                <td th:text="${membership.productName}"></td>
                                <td>
                                    <!-- ì”ì—¬íšŸìˆ˜ ì¡°ê±´ë¶€ -->
                                    <span class="badge bg-danger"
                                          th:if="${membership.remainingCount != null and membership.remainingCount != '-' and T(Integer).parseInt(membership.remainingCount) <= 3}"
                                          th:text="'ì”ì—¬ ' + ${membership.remainingCount}">
                                        </span>
                                    <span class="badge bg-success"
                                          th:if="${membership.remainingCount != null and membership.remainingCount != '-' and T(Integer).parseInt(membership.remainingCount) > 3}"
                                          th:text="'ì”ì—¬ ' + ${membership.remainingCount}">
                                        </span>
                                    <span class="badge bg-secondary"
                                          th:if="${membership.remainingCount == '-'}"
                                          th:text="${membership.remainingCount}">
                                        </span>
                                </td>
                                <td th:text="${#temporals.format(membership.endDate, 'yyyy-MM-dd')}"></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- ëª¨ë°”ì¼ ì¹´ë“œ -->
                    <div class="card-mobile">
                        <div th:each="membership : ${membershipMembers}" class="card shadow-sm mb-2 p-3">
                            <div class="fw-bold" th:text="${membership.memberName}"></div>
                            <div class="text-muted small" th:text="${membership.phone}"></div>
                            <div class="mt-2">
                                <span class="badge bg-secondary" th:text="${membership.productName}"></span>
                            </div>
                            <div class="mt-2">
                                <!-- ì”ì—¬íšŸìˆ˜ ì¡°ê±´ë¶€ -->
                                <span class="badge bg-danger"
                                      th:if="${membership.remainingCount != null and membership.remainingCount != '-' and T(Integer).parseInt(membership.remainingCount) <= 3}"
                                      th:text="'ì”ì—¬ ' + ${membership.remainingCount}">
                                </span>
                                <span class="badge bg-success"
                                      th:if="${membership.remainingCount != null and membership.remainingCount != '-' and T(Integer).parseInt(membership.remainingCount) > 3}"
                                      th:text="'ì”ì—¬ ' + ${membership.remainingCount}">
                                </span>
                                <span class="badge bg-secondary"
                                      th:if="${membership.remainingCount == '-'}"
                                      th:text="${membership.remainingCount}">
                                </span>
                            </div>
                            <div class="mt-2 small text-muted">
                                ì¢…ë£Œì¼: [[${#temporals.format(membership.endDate, 'yyyy-MM-dd')}]]
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
</html>
